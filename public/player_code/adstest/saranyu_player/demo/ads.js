var adsManager,adsLoader,adDisplayContainer,intervalTimer,playButton,videoContent;function init(){videoContent=document.getElementById("contentElement"),(playButton=document.getElementById("playButton")).addEventListener("click",playAds),setUpIMA()}function setUpIMA(){createAdDisplayContainer(),(adsLoader=new google.ima.AdsLoader(adDisplayContainer)).addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,onAdsManagerLoaded,!1),adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,onAdError,!1);var e=new google.ima.AdsRequest;e.adTagUrl="http://pubads.g.doubleclick.net/gampad/ads?sz=400x300&iu=%2F6062%2Fiab_vast_samples&ciu_szs=300x250%2C728x90&impl=s&gdfp_req=1&env=vp&output=xml_vast2&unviewed_position_start=1&url=[referrer_url]&correlator=[timestamp]&cust_params=iab_vast_samples%3Dimageoverlay",e.linearAdSlotWidth=640,e.linearAdSlotHeight=400,e.nonLinearAdSlotWidth=640,e.nonLinearAdSlotHeight=150,adsLoader.requestAds(e)}function createAdDisplayContainer(){adDisplayContainer=new google.ima.AdDisplayContainer(document.getElementById("adContainer"),videoContent)}function playAds(){videoContent.load(),adDisplayContainer.initialize();try{adsManager.init(640,360,google.ima.ViewMode.NORMAL),adsManager.start()}catch(e){videoContent.play()}}function onAdsManagerLoaded(e){var n=new google.ima.AdsRenderingSettings;n.useStyledNonLinearAds=!0,n.restoreCustomPlaybackStateOnAdBreakComplete=!0,(adsManager=e.getAdsManager(videoContent,n)).addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,onAdError),adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,onContentPauseRequested),adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,onContentResumeRequested),adsManager.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,onAdEvent),adsManager.addEventListener(google.ima.AdEvent.Type.LOADED,onAdEvent),adsManager.addEventListener(google.ima.AdEvent.Type.STARTED,onAdEvent),adsManager.addEventListener(google.ima.AdEvent.Type.COMPLETE,onAdEvent)}function onAdEvent(e){var n=e.getAd();switch(e.type){case google.ima.AdEvent.Type.LOADED:n.isLinear()||videoContent.play();break;case google.ima.AdEvent.Type.STARTED:n.isLinear()&&(intervalTimer=setInterval(function(){adsManager.getRemainingTime()},300));break;case google.ima.AdEvent.Type.COMPLETE:n.isLinear()&&clearInterval(intervalTimer)}}function onAdError(e){console.log(e.getError()),adsManager.destroy()}function onContentPauseRequested(){videoContent.pause()}function onContentResumeRequested(){videoContent.play()}init();